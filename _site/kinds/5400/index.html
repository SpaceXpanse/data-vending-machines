<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, minimum-scale=1.0">
<title>Nostr Event Count</title>

	<meta name="description" content="Job request to count matching events">


<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,700,700i|Noto+Sans:400,400i,700,700i|Source+Code+Pro&amp;subset=latin-ext">
<link rel="stylesheet" href="/doks-theme/assets/css/style.css">

	</head>
	<body class="blue" data-spy="scroll" data-target=".js-scrollspy">
		
	<div class="offcanvas visible-xs">
		<ul class="offcanvas__nav">
			
				<li><a href="/">Home</a></li>
			
				<li><a href="https://github.com/nostr-protocol/nips/blob/vending-machine/90.md">NIP-90</a></li>
			
		</ul><!-- /.offcanvas__nav -->
	</div><!-- /.offcanvas -->



	<header class="site-header">
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					
						<a href="/" class="site-header__logo">Data Vending Machine</a>
					
					
						<ul class="site-header__nav hidden-xs">
							
								<li><a href="/">Home</a></li>
							
								<li><a href="https://github.com/nostr-protocol/nips/blob/vending-machine/90.md">NIP-90</a></li>
							
						</ul><!-- /.site-header__nav -->
						<button class="offcanvas-toggle visible-xs">
							<span></span>
							<span></span>
							<span></span>
						</button><!-- /.offcanvas-toggle -->
					
				</div><!-- /.col -->
			</div><!-- /.row -->
		</div><!-- /.container -->
	</header><!-- /.site-header -->


		<div class="hero-subheader">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="align-container" data-mh>
							<div class="align-inner">
								
									<h1 class="hero-subheader__title">Nostr Event Count</h1>
								
								
									<p class="hero-subheader__desc">Job request to count matching events</p>
								
								
							</div><!-- /.align-inner -->
						</div><!-- /.align-container -->
					</div><!-- /.col -->
					
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.hero-subheader -->
		<div class="section">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="content">
							<h1 id="input">Input</h1>

<p>The input MUST be a JSON-encoded list of filters as specified in NIP 01.</p>

<h1 id="output">Output</h1>

<p><code class="language-plaintext highlighter-rouge">content</code> MUST contain a stringified number representing the final count. DVMs MAY return partial results using kind 7000 in the same format.</p>

<h1 id="params">Params</h1>

<ul>
  <li><code class="language-plaintext highlighter-rouge">relay</code>: a relay url to include in the count (required, client MAY provide more than one relay)</li>
  <li><code class="language-plaintext highlighter-rouge">group</code>: an event field or tag name to group results by, resulting in a potentially nested dictionary of results (optional, client MAY provide more than one group). Supported groups include:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">content</code> - an event’s <code class="language-plaintext highlighter-rouge">content</code> field</li>
      <li><code class="language-plaintext highlighter-rouge">pubkey</code> - an event’s <code class="language-plaintext highlighter-rouge">pubkey</code> field</li>
      <li><code class="language-plaintext highlighter-rouge">reply</code> - an event’s <code class="language-plaintext highlighter-rouge">reply</code> e-tag</li>
      <li><code class="language-plaintext highlighter-rouge">root</code> - an event’s <code class="language-plaintext highlighter-rouge">root</code> e-tag</li>
      <li>Any other value will be assumed to be a tag name. The first matching tag’s value will be used.</li>
    </ul>
  </li>
</ul>

<h1 id="how-clients-can-use-this">How clients can use this</h1>

<p>Clients may want to avoid downloading large datasets from many relays simply in order to de-duplicate and count them. This can be useful for a number of things:</p>

<ul>
  <li>Counting pubkey followers and other social graph analysis like web of trust score calculation</li>
  <li>Retrieving counts for list pages (number of messages in a conversation, number of lists on a profile)</li>
  <li>Getting metadata for tags (this topic has been used x times)</li>
</ul>

<h1 id="example">Example</h1>

<h4 id="request">Request</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[{</span><span class="se">\"</span><span class="s2">#t</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">zapathon</span><span class="se">\"</span><span class="s2">]}]"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="mi">5400</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="response">Response</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="mi">6400</span><span class="p">,</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"129469"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="request-1">Request</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[{</span><span class="se">\"</span><span class="s2">#kinds</span><span class="se">\"</span><span class="s2">:[7], </span><span class="se">\"</span><span class="s2">#e</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">7b0d90f1973da1cea186c85fbd09b3e4e455ce4d438b60a3d1f9aabc1681418f</span><span class="se">\"</span><span class="s2">}]"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="mi">5400</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">[</span><span class="s2">"param"</span><span class="p">,</span><span class="w"> </span><span class="s2">"group"</span><span class="p">,</span><span class="w"> </span><span class="s2">"content"</span><span class="p">]</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="response-1">Response</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="mi">6400</span><span class="p">,</span><span class="w">
    </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">🤙</span><span class="se">\"</span><span class="s2">:224,</span><span class="se">\"</span><span class="s2">+</span><span class="se">\"</span><span class="s2">:31,</span><span class="se">\"</span><span class="s2">🧡</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">❤️</span><span class="se">\"</span><span class="s2">:7,</span><span class="se">\"</span><span class="s2">🤣</span><span class="se">\"</span><span class="s2">:3,</span><span class="se">\"</span><span class="s2">⚡</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">💜</span><span class="se">\"</span><span class="s2">:7,</span><span class="se">\"</span><span class="s2">:thinking face:</span><span class="se">\"</span><span class="s2">:1,</span><span class="se">\"</span><span class="s2">🦶</span><span class="se">\"</span><span class="s2">:1,</span><span class="se">\"</span><span class="s2">🍺</span><span class="se">\"</span><span class="s2">:1,</span><span class="se">\"</span><span class="s2">🍆</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">🤙🏼</span><span class="se">\"</span><span class="s2">:3,</span><span class="se">\"</span><span class="s2">🔥</span><span class="se">\"</span><span class="s2">:2,</span><span class="se">\"</span><span class="s2">🏇</span><span class="se">\"</span><span class="s2">:1,</span><span class="se">\"</span><span class="s2">💚</span><span class="se">\"</span><span class="s2">:1}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

						</div><!-- /.content -->
					</div><!-- /.col -->
					<div class="col-md-4 col-md-offset-1">
						<div class="sections-list-wrapper">
							<div class="sections-list js-sections js-affix js-scrollspy hidden-xs hidden-sm"></div><!-- /.sections-list -->
						</div>
					</div><!-- /.col -->
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.section -->
		
		<div class="js-footer-area">
			
			
			
	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-sm-6">
					
						<a href="/" class="site-footer__logo">Data Vending Machine</a>
					
					
						<hr>
						<p class="site-footer__copyright">MIT License</p>
					
				</div><!-- /.col -->
				
					<div class="col-sm-6 align-right">
						<ul class="social-list">
							
								<li>
									<a href="https://github.com/pablof7z/data-vending-machines.org" target="_blank" class="social-list__item social-list__item--github">
										<i class="icon icon--github"></i>
									</a>
								</li>
							
						</ul><!-- /.social-list -->
					</div><!-- /.col -->
				
			</div><!-- /.row -->
		</div><!-- /.container -->
	</footer><!-- /.site-footer -->


<script src="/doks-theme/assets/js/vendor/jquery.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/affix.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/scrollspy.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/matchHeight.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/scripts.min.js"></script>




		</div><!-- /.js-footer-area -->
	</body>
</html>
